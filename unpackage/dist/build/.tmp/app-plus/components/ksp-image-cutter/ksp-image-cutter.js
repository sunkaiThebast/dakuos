(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/ksp-image-cutter/ksp-image-cutter"],{2631:function(t,i,e){},2763:function(t,i,e){"use strict";(function(t,e){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var h={props:{url:{type:String,default:""},fixed:{type:Boolean,default:!1},width:{type:Number,default:200},height:{type:Number,default:200},maxWidth:{type:Number,default:1024},maxHeight:{type:Number,default:1024},blob:{type:Boolean,default:!0}},data:function(){return{mask:{show:!1},frame:{left:50,top:50,width:this.width,height:this.height},image:{left:20,top:20,width:300,height:400},real:{width:100,height:100},target:{width:this.width,height:this.height},touches:[],type:"",start:{frame:{left:0,top:0,width:0,height:0},image:{left:0,top:0,width:0,height:0}},timeoutId:-1,context:null}},mounted:function(){this.context=t.createCanvasContext("canvas",this),this.targetContext=t.createCanvasContext("target",this)},methods:{imageLoad:function(i){var e=this;this.mask.show=!0,this.real.width=i.detail.width,this.real.height=i.detail.height,this.image.width=i.detail.width,this.image.height=i.detail.height,this.frame.width=this.width,this.frame.height=this.height;var h=t.createSelectorQuery().in(this);h.select(".body").boundingClientRect(function(t){var i=t.width,h=t.height,a=e.frame.width,s=e.frame.height,r=.8*i,m=.8*h,f=r/a,o=m/s,g=f;f<o&&(g=o),r=a*g,m=s*g;var n=(i-r)/2,l=(h-m)/2;e.frame.width=r,e.frame.height=m,e.frame.left=n,e.frame.top=l;var c=e.image.width,u=e.image.height;f=r/c,o=m/u,g=f,f<o&&(g=o),e.image.width=c*g,e.image.height=u*g,e.image.left=(i-e.image.width)/2,e.image.top=(h-e.image.height)/2,setTimeout(function(){e.trimImage()},100)}).exec()},touchHandle:function(){},touchStart:function(t,i){this.stopTime(),this.mask.show=!1,0==this.touches.length&&(this.type=i,this.start.frame.left=this.frame.left,this.start.frame.top=this.frame.top,this.start.frame.width=this.frame.width,this.start.frame.height=this.frame.height,this.start.image.left=this.image.left,this.start.image.top=this.image.top,this.start.image.width=this.image.width,this.start.image.height=this.image.height);for(var e=t.changedTouches,h=0;h<e.length;h++){var a=e[h];this.touches.push(a)}},touchMove:function(t){this.stopTime(),t.preventDefault();var i=t.touches;if(1==this.touches.length)"plank"==this.type||"frame"==this.type||this.fixed?this.moveImage(this.touches[0],i[0]):this.scaleFrame(this.touches[0],i[0],this.type);else if(2==this.touches.length&&2==i.length){var e=this.touches[0],h=this.touches[1],a=i[0],s=i[1];if(e.identifier!=a.identifier){var r=a;a=s,s=r}this.scaleImage(e,h,a,s)}},touchEnd:function(t){this.type="",this.touches=[],this.startTime()},touchCancel:function(t){this.type="",this.touches=[],this.startTime()},startTime:function(){var t=this;this.stopTime(),this.timeoutId=setTimeout(function(){t.trimImage()},800)},stopTime:function(){this.timeoutId>=0&&(clearTimeout(this.timeoutId),this.timeoutId=-1)},trimImage:function(){var i=this;this.mask.show=!0;var e=t.createSelectorQuery().in(this);e.select(".body").boundingClientRect(function(t){var e=t.width,h=t.height,a=i.frame.width,s=i.frame.height,r=.8*e,m=.8*h,f=r/a,o=m/s,g=f;f>o&&(g=o),r=a*g,m=s*g;var n=(e-r)/2,l=(h-m)/2,c=n-i.frame.left,u=l-i.frame.top;i.frame.width=r,i.frame.height=m,i.frame.left=n,i.frame.top=l,i.image.width*=g,i.image.height*=g,i.image.left+=c,i.image.top+=u}).exec(),setTimeout(function(){var t=i.image.width/i.real.width,e=(i.frame.left-i.image.left)/t,h=(i.frame.top-i.image.top)/t,a=i.frame.width/t,s=i.frame.height/t;i.context.drawImage(i.url,e,h,a,s,0,0,i.frame.width,i.frame.height),i.context.draw(!1)},100)},moveImage:function(t,i){var e=i.clientX-t.clientX,h=i.clientY-t.clientY;this.image.left=this.start.image.left+e,this.image.top=this.start.image.top+h,this.image.left>this.frame.left&&(this.image.left=this.frame.left),this.image.top>this.frame.top&&(this.image.top=this.frame.top),this.image.left+this.image.width<this.frame.left+this.frame.width&&(this.image.left=this.frame.left+this.frame.width-this.image.width),this.image.top+this.image.height<this.frame.top+this.frame.height&&(this.image.top=this.frame.top+this.frame.height-this.image.height)},scaleImage:function(t,i,e,h){var a=t.clientX,s=t.clientY,r=i.clientX,m=i.clientY,f=e.clientX,o=e.clientY,g=h.clientX,n=h.clientY,l=Math.sqrt((a-r)*(a-r)+(s-m)*(s-m)),c=Math.sqrt((f-g)*(f-g)+(o-n)*(o-n)),u=(a+r)/2,d=(s+m)/2,p=(f+g)/2,w=(o+n)/2,v=p-u,b=w-d,x=c/l;this.start.image.width*x<this.frame.width&&(x=this.frame.width/this.start.image.width),this.start.image.height*x<this.frame.height&&(x=this.frame.height/this.start.image.height),this.start.image.width*x<this.frame.width&&(x=this.frame.width/this.start.image.width),this.image.left=this.start.image.left+v-(u-this.start.image.left)*(x-1),this.image.top=this.start.image.top+b-(d-this.start.image.top)*(x-1),this.image.width=this.start.image.width*x,this.image.height=this.start.image.height*x,this.image.left>this.frame.left&&(this.image.left=this.frame.left),this.image.top>this.frame.top&&(this.image.top=this.frame.top),this.image.left+this.image.width<this.frame.left+this.frame.width&&(this.image.left=this.frame.left+this.frame.width-this.image.width),this.image.top+this.image.height<this.frame.top+this.frame.height&&(this.image.top=this.frame.top+this.frame.height-this.image.height)},scaleFrame:function(t,i,e){var h=i.clientX-t.clientX,a=i.clientY-t.clientY,s=this.start.frame.left,r=this.start.frame.top,m=this.start.frame.left+this.start.frame.width,f=this.start.frame.top+this.start.frame.height;"left"==e?s+=h:"right"==e?m+=h:"top"==e?r+=a:"bottom"==e?f+=a:"left-top"==e?(s+=h,r+=a):"left-bottom"==e?(s+=h,f+=a):"right-top"==e?(m+=h,r+=a):"right-bottom"==e&&(m+=h,f+=a),s<this.image.left&&(s=this.image.left),r<this.image.top&&(r=this.image.top),m>this.image.left+this.image.width&&(m=this.image.left+this.image.width),f>this.image.top+this.image.height&&(f=this.image.top+this.image.height),this.frame.left=s,this.frame.top=r,this.frame.width=m-s,this.frame.height=f-r},parseBlob:function(t){for(var i=t.split(","),e=i[0].match(/:(.*?);/)[1],h=atob(i[1]),a=h.length,s=new Uint8Array(a),r=0;r<a;r++)s[r]=h.charCodeAt(r);var m=URL||webkitURL;return m.createObjectURL(new Blob([s],{type:e}))},onok:function(){var i=this,h=this.image.width/this.real.width,a=(this.frame.left-this.image.left)/h,s=(this.frame.top-this.image.top)/h,r=this.frame.width/h,m=this.frame.height/h,f=r,o=m;if(this.fixed)f=this.width/2,o=this.height/2;else{if(f>this.maxWidth/2){var g=this.maxWidth/2/f;f*=g,o*=g}if(o>this.maxHeight/2){g=this.maxHeight/2/o;o*=g,f*=g}}this.target.width=f,this.target.height=o,setTimeout(function(){i.targetContext.drawImage(i.url,a,s,r,m,0,0,f,o),i.targetContext.draw(!1,function(){t.canvasToTempFilePath({canvasId:"target",success:function(t){var e=t.tempFilePath;i.$emit("ok",{path:e})},fail:function(t){console.log(e(t," at components\\ksp-image-cutter\\ksp-image-cutter.vue:438"))}},i)})},100)},oncancle:function(){this.$emit("cancel")}}};i.default=h}).call(this,e("6e42")["default"],e("0de9")["default"])},"6b5a":function(t,i,e){"use strict";e.r(i);var h=e("2763"),a=e.n(h);for(var s in h)"default"!==s&&function(t){e.d(i,t,function(){return h[t]})}(s);i["default"]=a.a},"6f3c":function(t,i,e){"use strict";var h=e("2631"),a=e.n(h);a.a},daef:function(t,i,e){"use strict";var h,a=function(){var t=this,i=t.$createElement;t._self._c},s=[];e.d(i,"b",function(){return a}),e.d(i,"c",function(){return s}),e.d(i,"a",function(){return h})},ebcb:function(t,i,e){"use strict";e.r(i);var h=e("daef"),a=e("6b5a");for(var s in a)"default"!==s&&function(t){e.d(i,t,function(){return a[t]})}(s);e("6f3c");var r,m=e("f0c5"),f=Object(m["a"])(a["default"],h["b"],h["c"],!1,null,null,null,!1,h["a"],r);i["default"]=f.exports}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/ksp-image-cutter/ksp-image-cutter-create-component',
    {
        'components/ksp-image-cutter/ksp-image-cutter-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('6e42')['createComponent'](__webpack_require__("ebcb"))
        })
    },
    [['components/ksp-image-cutter/ksp-image-cutter-create-component']]
]);
